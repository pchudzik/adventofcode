import pytest
import importlib

module = importlib.import_module("09_marble_mania")
Board = module.Board
play = module.play


@pytest.mark.parametrize(
    "players, marbles, expected_board", [
        [7, 1, (0, 1)],
        [7, 2, (0, 2, 1)],
        [7, 3, (0, 2, 1, 3)],
        [7, 4, (0, 4, 2, 1, 3)],
        [7, 5, (0, 4, 2, 5, 1, 3)],
        [7, 6, (0, 4, 2, 5, 1, 6, 3)],
        [7, 7, (0, 4, 2, 5, 1, 6, 3, 7)],
        [7, 8, (0, 8, 4, 2, 5, 1, 6, 3, 7)],
        [7, 9, (0, 8, 4, 9, 2, 5, 1, 6, 3, 7)],
        [7, 10, (0, 8, 4, 9, 2, 10, 5, 1, 6, 3, 7)],
        [7, 11, (0, 8, 4, 9, 2, 10, 5, 11, 1, 6, 3, 7)],
        [7, 12, (0, 8, 4, 9, 2, 10, 5, 11, 1, 12, 6, 3, 7)],
        [7, 13, (0, 8, 4, 9, 2, 10, 5, 11, 1, 12, 6, 13, 3, 7)],
        [7, 14, (0, 8, 4, 9, 2, 10, 5, 11, 1, 12, 6, 13, 3, 14, 7)],
        [7, 15, (0, 8, 4, 9, 2, 10, 5, 11, 1, 12, 6, 13, 3, 14, 7, 15)],
        [7, 16, (0, 16, 8, 4, 9, 2, 10, 5, 11, 1, 12, 6, 13, 3, 14, 7, 15)],
        [7, 17, (0, 16, 8, 17, 4, 9, 2, 10, 5, 11, 1, 12, 6, 13, 3, 14, 7, 15)],
        [7, 22, (0, 16, 8, 17, 4, 18, 9, 19, 2, 20, 10, 21, 5, 22, 11, 1, 12, 6, 13, 3, 14, 7, 15)],
        [7, 23, (0, 16, 8, 17, 4, 18, 19, 2, 20, 10, 21, 5, 22, 11, 1, 12, 6, 13, 3, 14, 7, 15)],
        [7, 24, (0, 16, 8, 17, 4, 18, 19, 2, 24, 20, 10, 21, 5, 22, 11, 1, 12, 6, 13, 3, 14, 7, 15)],
        [7, 25, (0, 16, 8, 17, 4, 18, 19, 2, 24, 20, 25, 10, 21, 5, 22, 11, 1, 12, 6, 13, 3, 14, 7, 15)],
    ])
def test_board_simple(players, marbles, expected_board):
    board = Board()

    play(board, players, marbles)

    assert board.board == list(expected_board)


@pytest.mark.parametrize("players, last_marble, highest_score", [
    [10, 25, 32],
    [10, 1618, 8317],
    [13, 7999, 146373],
    [17, 1104, 2764],
    [21, 6111, 54718],
    [30, 5807, 37305],
])
def test_scores(players, last_marble, highest_score):
    board = Board()

    max_score = play(board, players, last_marble)

    assert max_score == highest_score
